<!--
  4 types:
    isStudentRequestingFeedback
    - student request feedback (create)
    isStudentReadingFeedback
    isLecturerReadingFeedback
    - student read received feedback / lecturer read given feedback (read)
    isLecturerWritingFeedback
    isLecturerRespondingToFeedbackRequest
    - lecturer write feedback / lecturer respond to requested feedback (create)
    isLecturerEditingFeedback
    - lecturer edit given feedback (update)

    would not be done in the modal
    - lecturer delete given feedback (delete)
-->

<!--REQUEST FEEDBACK STUDENT-->
<ion-toolbar *ngIf="isStudentRequestingFeedback">
  <ion-title>Feedback request to Lecturer {{ data.name }}</ion-title>
  <ion-buttons slot="end">
    <ion-button (click)="close()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-toolbar>

<ion-content *ngIf="isStudentRequestingFeedback" class="ion-padding">
  <form (ngSubmit)="requestFeedback()" (keyup)="checkRequestValidity()">
    <ion-item>
    <ion-label>Context:</ion-label>
      <ion-select interface="popover" name="requested-context" (ionChange)="checkRequestValidity()" [(ngModel)]="requestedContext">
        <ion-select-option value="context1">context1</ion-select-option>
        <ion-select-option value="context2">context2</ion-select-option>
        <ion-select-option value="context3">context3</ion-select-option>
      </ion-select>
    </ion-item>
    <ion-item>
      <ion-label position="floating">Description:</ion-label>
      <ion-textarea type="text" rows="8" [(ngModel)]="requestedDescription" name="requested-desciption"></ion-textarea>
    </ion-item>
    <ion-item>
      <ion-icon name="attach"></ion-icon>
      <ion-text>name of the attachment</ion-text>
      <ion-icon name="close"></ion-icon>
    </ion-item>
    <p *ngIf="!isRequestedContextValid || !isRequestedDescriptionValid"><ion-button type="submit" disabled="true" class="invalid_btn">Confirm</ion-button></p>
    <p *ngIf="isRequestedContextValid && isRequestedDescriptionValid"><ion-button type="submit" class="valid_btn">Confirm</ion-button></p>  
  </form>
</ion-content>
    
<!--READING FEEDBACK-->
<ion-toolbar *ngIf="isStudentReadingFeedback || isLecturerReadingFeedback">
  <ion-title *ngIf="isLecturerReadingFeedback">Reading Given Feedback</ion-title>
  <ion-title *ngIf="isStudentReadingFeedback">Reading Given Feedback</ion-title>  
  <ion-buttons slot="end">
    <ion-button (click)="close()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-toolbar>

<ion-content class="ion-padding" *ngIf="isStudentReadingFeedback || isLecturerReadingFeedback">
  <p>Context: {{ data.context }}</p>
  <p>Description: {{ data.description }}</p>
  <p *ngIf="isLecturerReadingFeedback"><ion-button (click)="editFeedback()" class="valid_btn">Edit</ion-button></p>
  <p *ngIf="isLecturerReadingFeedback"><ion-button disabled="true" class="invalid_btn">Delete</ion-button></p>
</ion-content>

<!--RESPONDING TO REQUEST LECTURER-->
<ion-toolbar *ngIf="isLecturerRespondingToFeedbackRequest">
  <ion-buttons *ngIf="isLecturerWritingResponseFeedback" slot="start">
    <ion-button (click)="checkRequest()">
      <ion-icon slot="icon-only" name="md-return-left"></ion-icon>
    </ion-button>
  </ion-buttons>
  <ion-title *ngIf="!isLecturerWritingResponseFeedback && isLecturerRespondingToFeedbackRequest">Feedback request</ion-title>
  <ion-title *ngIf="isLecturerWritingResponseFeedback && isLecturerRespondingToFeedbackRequest">Feedback request response</ion-title>
  <ion-buttons slot="end">
    <ion-button (click)="close()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-toolbar>

<ion-content *ngIf="!isLecturerWritingResponseFeedback && isLecturerRespondingToFeedbackRequest" class="ion-padding">
  <p>Context: {{ data.context }}</p>
  <p>Description: {{ data.description }}</p>
  <p><ion-button (click)="writeFeedback()" class="valid_btn">Write</ion-button></p>
</ion-content>

<ion-content *ngIf="isLecturerWritingResponseFeedback && isLecturerRespondingToFeedbackRequest" class="ion-padding">
  <form (ngSubmit)="sendForm()" (keyup)="checkDescription()">
    <ion-item>
      <ion-label position="floating">Context:</ion-label>
        <!--<ion-select interface="popover" name="context" [(ngModel)]="writtenContext">-->
        <ion-select interface="popover" name="context" [(ngModel)]="feedbackResponse.context" #context="ngModel">
        <ion-select-option value="context1">context1</ion-select-option>
        <ion-select-option value="context2">context2</ion-select-option>
        <ion-select-option value="context3">context3</ion-select-option>
      </ion-select>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Description:</ion-label>
      <!--<ion-textarea type="text" rows="8" [(ngModel)]="writtenDescription" name="desciption"></ion-textarea>-->
      <ion-textarea type="text" rows="8" [(ngModel)]="writtenDescription" name="desciption"></ion-textarea>
    </ion-item>
    <!--
    <p *ngIf="!isDescriptionValid"><ion-button type="submit" disabled="true" class="invalid_btn">Send</ion-button></p> 
    <p *ngIf="isDescriptionValid"><ion-button type="submit" class="valid_btn">Send</ion-button></p>  
    -->
  </form>
</ion-content>

<!-- READING GIVEN FEEDBACK / EDITTING GIVEN FEEDBACK -->
<ion-toolbar *ngIf="isLecturerReadingGivenFeedback">
  <ion-buttons *ngIf="isLecturerEditingGivenFeedback" slot="start">
    <ion-button (click)="checkFeedback()">
      <ion-icon slot="icon-only" name="md-return-left"></ion-icon>
    </ion-button>
  </ion-buttons>
  <ion-title *ngIf="isLecturerReadingGivenFeedback && !isLecturerEditingGivenFeedback">Feedback review</ion-title>
  <ion-title *ngIf="isLecturerReadingGivenFeedback && isLecturerEditingGivenFeedback">Feedback editing</ion-title>
  <ion-buttons slot="end">
    <ion-button (click)="close()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-toolbar>

<ion-content *ngIf="isLecturerReadingGivenFeedback && !isLecturerEditingGivenFeedback" class="ion-padding">
  <p>Context: {{ data.context }}</p>
  <p>Description: {{ data.description }}</p>
  <p><ion-button (click)="editFeedback()" [disabled]="!data.hasBeenOpened" [class]="data.hasBeenOpened ? 'valid_btn' : 'invalid_btn'">Edit</ion-button></p>
  <p><ion-button [disabled]="!data.hasBeenOpened" [class]="data.hasBeenOpened ? 'valid_btn' : 'invalid_btn'">Delete</ion-button></p>
</ion-content>

<ion-content *ngIf="isLecturerReadingGivenFeedback && isLecturerEditingGivenFeedback" class="ion-padding">
  <form (ngSubmit)="editForm()" (keyup)="checkEditedDescription()">
    <ion-item>
    <ion-label>Context:</ion-label>
      <ion-select interface="popover" name="edited-context" [(ngModel)]="editedContext">
        <ion-select-option value="context1">context1</ion-select-option>
        <ion-select-option value="context2">context2</ion-select-option>
        <ion-select-option value="context3">context3</ion-select-option>
      </ion-select>
    </ion-item>
    
    <ion-item>
      <ion-label position="floating">Description:</ion-label>
      <ion-textarea type="text" rows="8" [(ngModel)]="editedDescription" name="edited-desciption"></ion-textarea>
    </ion-item>
    <ion-item>
      <ion-icon name="attach"></ion-icon>
      <ion-text>name of the attachment</ion-text>
      <ion-icon name="close"></ion-icon>
      </ion-item>
    <!--
    <p *ngIf="!isEditedDescriptionValid"><ion-button type="submit" disabled="true" class="invalid_btn">Confirm</ion-button></p>  
    <p *ngIf="isEditedDescriptionValid"><ion-button type="submit" class="valid_btn">Confirm</ion-button></p>  
    -->
  </form>
</ion-content>

<!--WRITING FEEDBACK LECTURER-->
<ion-toolbar *ngIf="isLecturerWritingFeedback">
  <ion-title *ngIf="isLecturerWritingFeedback">Feedback request response</ion-title>
  <ion-buttons slot="end">
    <ion-button (click)="close()">
      <ion-icon slot="icon-only" name="close"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-toolbar>

<ion-content *ngIf="isLecturerWritingFeedback" class="ion-padding">
  <form (ngSubmit)="sendForm()" (keyup)="checkDescription()">
    <ion-item>
      <ion-label position="floating">Context:</ion-label>
        <ion-select interface="popover" name="context" [(ngModel)]="writtenContext">
        <ion-select-option value="context1">context1</ion-select-option>
        <ion-select-option value="context2">context2</ion-select-option>
        <ion-select-option value="context3">context3</ion-select-option>
      </ion-select>
    </ion-item>

    <ion-item>
      <ion-label position="floating">Description:</ion-label>
      <ion-textarea type="text" rows="8" [(ngModel)]="writtenDescription" name="desciption"></ion-textarea>
    </ion-item>
    <p *ngIf="!isDescriptionValid"><ion-button type="submit" disabled="true" class="invalid_btn">Send</ion-button></p> 
    <p *ngIf="isDescriptionValid"><ion-button type="submit" class="valid_btn">Send</ion-button></p>  
  </form>
</ion-content>

<!-- FEEDBACK WRITING ACTIONS -->
<ion-item class="feedback-actions" *ngIf="isStudentRequestingFeedback || isLecturerWritingResponseFeedback || isLecturerEditingGivenFeedback || isLecturerWritingFeedback">
  <ion-buttons>
    <ion-button class="secondary-action-icon" (click)="attachFile()">
      <ion-icon name="attach"></ion-icon>
    </ion-button>
        
    <ion-button class="primary-action-icon" (click)="toggleRecording()"> 
      <ion-icon [name]="isRecording ? 'pause' : 'radio-button-on'"></ion-icon>
    </ion-button>
    
    <ion-button *ngIf="isLecturerWritingResponseFeedback" class="secondary-action-icon" [disabled]="!isFormValid" (click)="sendForm()">
      <ion-icon [ngClass]="isFormValid ? '' : ''" name="send"></ion-icon>
    </ion-button>

    <ion-button *ngIf="isLecturerEditingGivenFeedback" class="secondary-action-icon" [disabled]="!isFormValid" (click)="editForm()">
      <ion-icon [ngClass]="isFormValid ? '' : ''" name="send"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-item>
